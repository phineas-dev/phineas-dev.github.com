---
import { getCollection } from 'astro:content';
import PostCard from '../../components/PostCard.astro';
import DefaultLayout from '../../layouts/DefaultLayout.astro';
import Highlight from '../../components/Highlight.astro';

// Get all posts and sort by date
const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

// Select a random post as featured
const randomIndex = Math.floor(Math.random() * posts.length);
const featuredPost = posts[randomIndex];

// Filter out the featured post from other posts
const otherPosts = posts.filter((_, index) => index !== randomIndex);
---

<DefaultLayout 
  title="Tech Blog" 
  description="A collection of articles about technology and related topics"
  slug='tech-blog'
  showArt={true}
>
  <section class="max-w-4xl mx-auto">
    <div class="mb-12">
      <div class="text-[1.125rem] max-w-3xl">
        <p class="text-gray-950 dark:text-gray-300 mb-6 leading-[1.75] tracking-[-0.01em]">
          A collection of articles about <Highlight>web development</Highlight>, <Highlight>software architecture</Highlight>, 
          and <Highlight>user experience</Highlight>. I write about my experiences building 
          <Highlight>high-performance applications</Highlight> and share insights about 
          <Highlight>modern development practices</Highlight>.
        </p>
      </div>
    </div>

    {featuredPost && (
      <div class="mb-12">
        <h2 class="text-[1.75rem] font-bold text-gray-900 dark:text-gray-100 tracking-tight mb-4">Recent Post</h2>
        <div class="space-y-3">
          <PostCard post={featuredPost} variant="featured" baseUrl='/tech-blog/' color={featuredPost.data.color} />
        </div>
      </div>
    )}

    <div class="mb-8">
      <h2 class="text-[1.75rem] font-bold text-gray-900 dark:text-gray-100 tracking-tight mb-4">More Posts</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {otherPosts.map((post) => (
          <div class="space-y-3">
            <PostCard post={post} variant="default" baseUrl='/tech-blog/' color={post.data.color} />
          </div>
        ))}
      </div>
    </div>
  </section>
</DefaultLayout>
