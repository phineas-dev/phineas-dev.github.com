---
import { getCollection } from 'astro:content';
import PostCard from '../../components/PostCard.astro';
import DefaultLayout from '../../layouts/DefaultLayout.astro';
import Highlight from '../../components/Highlight.astro';

// Get all posts and sort by date
const posts = (await getCollection('projects')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

// Select a random post as featured
const randomIndex = Math.floor(Math.random() * posts.length);
const featuredPost = posts[randomIndex];

// Filter out the featured post from other posts
const otherPosts = posts.filter((_, index) => index !== randomIndex);
---

<DefaultLayout 
  title="Projects" 
  description="A showcase of my latest projects and work"
  slug='projects'
  showArt={true}
>
  <section class="max-w-4xl mx-auto">
    <div class="mb-12">
      <div class="text-[1.125rem] max-w-3xl">
        <p class="text-gray-900 dark:text-gray-200 mb-6 leading-[1.75] tracking-[-0.01em]">
          A curated portfolio showcasing my work in <Highlight>frontend development</Highlight>, 
          <Highlight>user experience design</Highlight>, and <Highlight>software architecture</Highlight>. 
          From <Highlight>high-traffic web applications</Highlight> to 
          <Highlight>innovative side projects</Highlight>.
        </p>
      </div>
    </div>

    {featuredPost && (
      <div class="mb-12">
        <h2 class="heading-1 mb-4">Recent Project</h2>
        <div class="space-y-3">
          <PostCard post={featuredPost} variant="featured" baseUrl='/projects/' color={featuredPost.data.color} />
        </div>
      </div>
    )}

    <div class="mb-8">
      <h2 class="heading-1 mb-4">More Projects</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {otherPosts.map((post) => (
          <div class="space-y-3">
            <PostCard post={post} variant="default" baseUrl='/projects/' color={post.data.color} />
          </div>
        ))}
      </div>
    </div>
  </section>
</DefaultLayout>
