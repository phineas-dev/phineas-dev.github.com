---
import { getCollection } from 'astro:content';
import Link from '../components/Link.astro';
import DefaultLayout from '../layouts/DefaultLayout.astro';
import BlendedImage from '../components/BlendedImage.astro';

const blogPosts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

const projectPosts = (await getCollection('projects')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);

const latestProject = projectPosts[0];
const latestPost = blogPosts[0];
---

<DefaultLayout title="Home" description='home page'>
	<main class="container mx-auto px-4 py-8">
		<section class="mb-8 bg-gray-50 dark:bg-gray-900 p-6 rounded-lg">
			<h1 class="text-4xl font-bold mb-4">Hi, I'm Phineas</h1>
			<p>I'm a frontend engineer with a passion for creating beautiful and functional web applications.</p>
		</section>
		<ul class="grid gap-4 text-xl mb-20">
			<li>View my <Link href="/resume">Resume</Link>. I am available for hire.</li>
		</ul>
		<div class="flex flex-col gap-8 lg:flex-row">
			<section class="flex-1">
				<div class="flex items-center justify-between mb-6">
					<h2 class="text-2xl font-bold">Latest Project</h2>
					<Link href="/projects" class="text-sm">View all projects →</Link>
				</div>
				<div class="mb-4">
					<a href={`/projects/${latestProject.slug}`} class="group block">
						<div class="relative mb-3">
							<BlendedImage 
								slug={latestProject.slug}
								title={latestProject.data.title}
								aspectRatio={40}
								hover={true}
								rounded={true}
							/>
						</div>
						<div class="text-sm text-gray-600 dark:text-gray-400">{new Date(latestProject.data.pubDate).toLocaleDateString('en-US', { year: 'numeric', month: 'short' })}</div>
						<div class="font-semibold my-1 text-gray-900 dark:text-gray-100 group-hover:text-cyan-700 dark:group-hover:text-cyan-300 transition-colors">{latestProject.data.title}</div>
						<div class="text-gray-700 dark:text-gray-300 text-sm">{latestProject.data.description}</div>
					</a>
				</div>
			</section>
			<section class="flex-1">
				<div class="flex items-center justify-between mb-6">
					<h2 class="text-2xl font-bold">Latest Blog Post</h2>
					<Link href="/tech-blog" class="text-sm text-cyan-700 dark:text-cyan-300">Read more posts →</Link>
				</div>
				<div class="mb-4">
					<a href={`/tech-blog/${latestPost.slug}`} class="group block">
						<div class="relative mb-3">
							<BlendedImage 
								slug={latestPost.slug}
								title={latestPost.data.title}
								aspectRatio={40}
								hover={true}
								rounded={true}
							/>
						</div>
						<div class="text-sm text-gray-600 dark:text-gray-400">{new Date(latestPost.data.pubDate).toLocaleDateString('en-US', { year: 'numeric', month: 'short' })}</div>
						<div class="font-semibold my-1 text-gray-900 dark:text-gray-100 group-hover:text-cyan-700 dark:group-hover:text-cyan-300 transition-colors">{latestPost.data.title}</div>
						<div class="text-gray-700 dark:text-gray-300 text-sm">{latestPost.data.description}</div>
					</a>
				</div>
			</section>
		</div>
	</main>
</DefaultLayout>
